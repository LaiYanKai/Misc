# Table of Contents
[4 &emsp; First Time Configuration of Ubuntu 22.04](#ubuntu-config)  
[5 &emsp; Installation of ROS2 and Software on Freshly-installed Ubuntu 22.04](#ros2)

# 1&emsp;Install Oracle VirtualBox 6.1 on Windows Host 
If you have Ubuntu 22.04 LTS on your system as a virtual machine or boot, ignore this section.
About 200MB of Wi-Fi is required for this section.
This course requires Ubuntu 22.04 because ROS2 Humble requires Ubuntu 22.04.  
The steps are meant for installing the VirtualBox virtual machine on a Windows 10 or 11 system. 
The instructions are not meant for Apple users, although it may be similar.
1. Go to https://www.virtualbox.org/wiki/Download_Old_Builds_6_1 to download the VirtualBox device. If your PC is on Windows, click `Windows hosts`.
2. Open the installer and click `Yes` or `Next` until the installer completes. You may encounter some information about missing Python dependencies, which can be ignored.
3. If using Windows, search for and click `Core Isolation` in the start menu. Turn off `Memory Integrity`, and close the window.
4. If using Windows, search for and click `Turn Windows features on or off` in the start menu. Look for and uncheck `Virtual Machine Platform`, click `OK`, and restart Windows.
5. Proceed to the next section.

# 2&emsp;Mounting Ubuntu 22.04 LTS in Oracle VirtualBox
About 7GB of Wi-Fi is required for this section.
  
  ---
1. Go to https://releases.ubuntu.com/jammy/ and download `64-bit PC (AMD64) desktop image` (`.iso`) which should be the first option. This is the **Ubuntu 22.04 Desktop Image**. This file size is approximately 4.7 GB.
  
  ---
2. Open Oracle VirtualBox. Ignore any prompts to update to version 7 and above by clicking `OK` or closing the prompt.
  
  ---
3. On VirtualBox, click `New` to create a new Virtual Machine. <br>
    ![image](https://github.com/user-attachments/assets/9ed52db8-30d8-4389-935f-e88402d6b618)

  ---
4. Type `Ubuntu 22.04` in the `Name` field and click `Next`. <br> 
  ![image](https://github.com/user-attachments/assets/ad53fac3-0778-4748-8d26-ed40a2d1ee11)

  ---
7. Slide the memory to the end of the green bar and click `Next`. <br>
  ![image](https://github.com/user-attachments/assets/04fa1cf0-4a06-4b74-a974-e1503651fac1)
  
  ---
8. Select `Create a virtual hard disk now` and click `Next`. <br>
  ![image](https://github.com/user-attachments/assets/ba5f7f98-9d05-4349-8d3c-4aa11c22ef7a)
  
  ---
9. Select `VDI` and click `Next`. <br>
  ![image](https://github.com/user-attachments/assets/8f8d4e62-72da-4fc6-ac24-e3c81a4b57f4)
  
  ---
10. Select `Dynamically allocated` and click `Next`. <br>
  ![image](https://github.com/user-attachments/assets/d04adc34-26dc-4af0-80ac-c0a570771ad6)
  
  ---
11. Select at least `30 GB` and click `Create`. <br>
  ![image](https://github.com/user-attachments/assets/2eec24fb-7d06-49ca-9f2d-6806b03db8c0)
  
  ---
12. Once you are back on the main page of VirtualBox, select the newly created virtual machine `Ubuntu 22.04`, and click `Settings`. <br>
    ![image](https://github.com/user-attachments/assets/a2afc59d-2827-4204-82e5-d6e5cb32bdad)
  
  ---
13. Under `General`, in the `Advanced` tab, select `Bidirectional` in `Shared Clipboard`. <br>
    ![image](https://github.com/user-attachments/assets/b75abb70-af03-45bd-9ffc-c8b38046927f)
  
  ---
14. Under `System`, in the `Processor` tab, slide the `Processor(s)` to end of the green bar. <br>
  ![image](https://github.com/user-attachments/assets/1c039266-2f68-45a2-81f8-e7fa62c54538)
  
  ---
15. Under `Display`, in the `Screen` tab, slide the `Video Memory` to the end of the green bar. <br>
  ![image](https://github.com/user-attachments/assets/6f6bd81f-6619-4683-af49-6bb3d0e55adb)
  
  ---
16. Under `Storage`, select `Empty` under `Storage Devices`, click the CD-rom icon on the right, and `Choose a disk file...` to find the Ubuntu 22.04 desktop image. <br>
    ![image](https://github.com/user-attachments/assets/bb0a094d-c327-44e6-ac17-2ad55ca1626d)
  
  ---
17. Click `OK` at the bottom-left of the Settings window, which will bring you back to the main window.
  
  ---
18. Select the `Ubuntu 22.04` virtual machine and click `Start`. <br>
    ![image](https://github.com/user-attachments/assets/5a5a32eb-77d2-47b6-a9dc-88fd54aab329)
  
  ---
19. Proceed to the next section.

# 3&emsp;Installing Ubuntu 22.04
An active internet connection will be required for this section.
This section applies for dual-boot or virtual machine installation. 
  
---
1. Select `Try or Install Ubuntu`, and wait for a few seconds to a few minutes for the Welcome screen to show. <br>
   ![image](https://github.com/user-attachments/assets/33ac2621-d42c-4e50-a1b7-fa077e0de896)
  
---
2. Select `English`, and `Install Ubuntu`. <br>
   ![Screenshot 2025-01-31 174851](https://github.com/user-attachments/assets/52d80848-b8c8-40e9-bbd6-36b325f8051c)
  
---
3. Select your keyboard layout. For non-exchange students, the default settings with the US keyboard will suffice. Click `Continue`. <br>
   ![image](https://github.com/user-attachments/assets/2b8617ea-2786-48a8-9180-49485c08ea57)
  
---
4. Select `Install third-party`... and click `Continue`. Wait for a few seconds to a few minutes. <br>
   ![image](https://github.com/user-attachments/assets/d2a3c299-ba92-430c-b391-b1244af837e9)
  
---
5. For VirtualBox users, select `Erase disk and install Ubuntu`, as this action only erases the empty virtual disk that was created in the previous section. For other users, please select carefully. Click `Install Now`. <br>
  ![image](https://github.com/user-attachments/assets/5ebe4002-bbfd-438f-b5f2-32cddaba4e46)
  
---
6. Select `Continue` for the partition changes. Wait for a few seconds to a few minutes. <br>
   ![image](https://github.com/user-attachments/assets/04ca12bd-f92e-4e38-b205-f0935d02bd8a)
  
---
7. Select your location and click `Continue`. 
  
---
8. Choose your username and password. Remember your password as it is required for any subsequent `sudo` terminal commands. You may choose to `Log in automatically` to hasten the booting process. Click `Continue`. <br>
    ![image](https://github.com/user-attachments/assets/5a74662e-db0b-41a8-a746-f5ffcccc8b07)
  
---
9. Wait for Ubuntu 22.04 to finish installing in a few minutes. Click `Restart Now` once it completes. <br>
    ![image](https://github.com/user-attachments/assets/b74d3005-4846-463f-a682-56d23abb4b92)
  
---
10. Press `Enter` when prompted. <br>
    ![image](https://github.com/user-attachments/assets/06fe3eba-8025-48a2-93c5-295143b00608)
  
---
11. Proceed to the next section.

<a name="ubuntu-install"></a>

<table>
<tr><td>1</td><td>
  Click <code>Skip</code>, <code>Next</code>, <code>Next</code>, <code>Next</code>, <code>Done</code> in the window that shows up in a freshly-installed Ubuntu 22.04.
</td></tr>

<tr><td>2</td><td>
  <b>Optional</b>. The icons on the dock can be removed so the workspace is not cluttered. Right-click the icons and click <code>Remove from Favorites</code> until <code>Files</code>, <code>Firefox</code> and <code>Trash</code> are left.
  <br/><br/>
  <img src="https://github.com/user-attachments/assets/f735c07e-60e3-45c0-9776-b5ec0b630e55"/>
</td></tr>
  
<tr><td>3</td><td>
  The following upgrade windows will appear after a few minutes, or in subsequent boots. For this course, always click <code>Don't Upgrade</code> (there is another window to click <code>OK</code>) and <code>Remind Me Later</code>. There is a rare chance that upgrades can cause bugs in the code and in ROS2.
  <br/><br/>
  <img src="https://github.com/user-attachments/assets/d9a0a34f-61b4-48c3-bd38-34d6ec157087"/>
</td></tr>

<tr><td>4</td><td>
  <b>Optional</b>.
  Click <code>Activities</code> on the top-left corner of the screen, and search for and click <code>Power</code> under the <code>Settings</code>. 
  Set the <code>Screen Blank</code> to <code>Never</code> to prevent undesirable screen blanks when reading or troubleshooting the code.
  <br/><br/>
  <img src="https://github.com/user-attachments/assets/a708e069-34cd-4616-99fb-c1bf4615f268" /><br/>
  <img src="https://github.com/user-attachments/assets/83611820-db37-46d1-8fc7-b665fcd9fd3d" />
</td></tr>

<tr><td>5</td><td>
  Proceed to the next section.
</td></tr>  
</table>



# 4&emsp;First-time Configuration of Ubuntu 22.04
<a name="ubuntu-config"></a>

<table>
<tr><td>1</td><td>
  Click <code>Skip</code>, <code>Next</code>, <code>Next</code>, <code>Next</code>, <code>Done</code> in the window that shows up in a freshly-installed Ubuntu 22.04.
</td></tr>

<tr><td>2</td><td>
  <b>Optional</b>. The icons on the dock can be removed so the workspace is not cluttered. Right-click the icons and click <code>Remove from Favorites</code> until <code>Files</code>, <code>Firefox</code> and <code>Trash</code> are left.
  <br/><br/>
  <img src="https://github.com/user-attachments/assets/f735c07e-60e3-45c0-9776-b5ec0b630e55"/>
</td></tr>
  
<tr><td>3</td><td>
  The following upgrade windows will appear after a few minutes, or in subsequent boots. For this course, always click <code>Don't Upgrade</code> (there is another window to click <code>OK</code>) and <code>Remind Me Later</code>. There is a rare chance that upgrades can cause bugs in the code and in ROS2.
  <br/><br/>
  <img src="https://github.com/user-attachments/assets/d9a0a34f-61b4-48c3-bd38-34d6ec157087"/>
</td></tr>

<tr><td>4</td><td>
  <b>Optional</b>.
  Click <code>Activities</code> on the top-left corner of the screen, and search for and click <code>Power</code> under the <code>Settings</code>. 
  Set the <code>Screen Blank</code> to <code>Never</code> to prevent undesirable screen blanks when reading or troubleshooting the code.
  <br/><br/>
  <img src="https://github.com/user-attachments/assets/a708e069-34cd-4616-99fb-c1bf4615f268" /><br/>
  <img src="https://github.com/user-attachments/assets/83611820-db37-46d1-8fc7-b665fcd9fd3d" />
</td></tr>

<tr><td>5</td><td>
  Proceed to the next section.
</td></tr>  
</table>


# 5&emsp;Installation of ROS2 and Software on Freshly-installed Ubuntu 22.04
<a name="ros2"></a>About 10GB of Wi-Fi is required in this section.

<table>
<tr><td>1</td><td>
In Ubuntu, open a terminal with <code>Ctrl+Alt+T</code>.
</td></tr>
  
<tr><td>2</td><td>
On the terminal, download the installation script used for installing the lab computers using the following command:
  <pre lang="bash">cd ~
wget https://raw.githubusercontent.com/laiyankai/misc/main/humble_install.sh</pre>
This script disables auto updates, auto sleeping, hibernating, and other manual interaction during updates. If you do not want these features, comment out the group of commands under the <code>[OPTIONAL]</code> comments by using <code>nano ~/humble_install.sh</code>, and saving and exiting using <code>Ctrl+S</code> and <code>Ctrl+X</code>.
</td></tr>
  
<tr><td>3</td><td>
Assign permissions to the script and run it:
  <pre lang="bash">cd ~
chmod +x humble_install.sh
./humble_install.sh</pre>
</td></tr>

<tr><td>4</td><td>
The password may be required in a box. Click <code>Authenticate</code> when done. 
  <br/><br/>
  <img src="https://github.com/user-attachments/assets/b95eb1b2-8d48-4ba5-8179-e09ee7e4a9d6"/>
</td></tr>
  
<tr><td>5</td><td>
Key in the password for the <code>sudo</code> commands. Take note that there will not be any visible feedback in the terminal when typing the password. Press <code>Enter</code> when done. 
  <br/><br/>
  <img src="https://github.com/user-attachments/assets/a1a088e2-09c0-4aad-b1da-a17a595aa086"/>
</td></tr>

<tr><td>6</td><td>
Wait for a few minutes as software is being updated and ROS is being downloaded and installed. If you have commented out the <code>[OPTIONAL]</code> features in <code>humble_install.sh</code>, you may be required to press <code>Enter</code> about a few minutes into the installation. 
</td></tr>

<tr><td>7</td><td>
If the installation does not stop at <code lang="bash">sudo set -i</code>..., there may be errors. Make sure there is an active internet connection and retry this section. 
  <br/><br/>
  <img src="https://github.com/user-attachments/assets/83701e5d-20da-4204-ad6c-b47eec01b63d"/>
</td></tr>
</table>

  
lt settings. Close the dialog with `Done`.
2. Remove all icons on the Dock except for `Files`, `Firefox` and `Trash`.
3. Disable the screen blank. Go to `Activities`, search for `Power`, and change the screen blank to `Never`.
4. Pull up a terminal with `Ctrl+Alt+T`.
5. Stop any unattended upgrades with:
```bash
sudo systemctl stop unattended-upgrades
```
6. If there is prompt to upgrade to 24.04, choose `Never`.
7. If there is prompt to update, choose `Remind Me later`.
8. On the terminal Download the `humble_install.sh` bash script, assign permissions, and install updates with:
```bash
wget https://raw.githubusercontent.com/laiyankai/misc/main/humble_install.sh
chmod +x *.sh
./humble_install.sh
```
Take note of any errors.

## 1.4 Gazebo
1. Close all terminals, and pull up a new one with `Ctrl+Alt+T`.
2. Wait for 5 to 10 minutes to load the `turtlebot3_house` Gazebo map:
```bash
ros2 launch turtlebot3_gazebo turtlebot3_house.launch.py
```
3. After loading, wait for 5 to 10 minutes to load the `turtlebot3_world` Gazebo map:
```bash
ros2 launch turtlebot3_gazebo turtlebot3_world.launch.py
```

## 1.5 VSCode
1. In `Activities`, search and click `Ubuntu Software`.
2. Look for the `Search` magnifying glass icon and search for `vscode`.
3. Select `code` and install it.
4. Once installed, open it.
5. Go to preferences with `Ctrl+,`, and search for `themes`, select a *light* theme.
6. In the extensions tab (`Ctrl+Shift+X`), look for `ROS`, and install the extension by Microsoft.

## 1.6 NoMachine install
1. In Firefox, Go to https://downloads.nomachine.com/download/?id=1 and download the linux AMD64 Nomachine Debian file.
2. On a terminal, install the debian file. Key in password where necessary.
```bash
cd ~/Downloads
sudo dpkg -i nomachine_8.14.2_1_amd64.deb
```

# 2 Tb3 Installations
## 2.1 Flash MicroSD Card
1. On a PC, flash the MicroSD card with RPi Imager, with the image `Ubuntu Desktop 22.04.5 LTS`.
2. Plug in the MicroSD card in to the RPi on the Tb3 once done.

## 2.2 Install script (Part 1)
1. Plug in the HDMI, keyboard, and the DC jack on to the OpenCR board.
2. Turn on the robot by flipping the swithc on the OpenCR board.
3. The screen should initially show a rainbow screen. If it does not for more than 30 seconds, turn off (flip the switch) and turn it on again.
4. Wait for the robot to boot. For the first time, it will prompt for a username and password. Key in as indicated.
5. Once logged in, edit the network configuration file.
```bash
sudo nano /etc/netplan/50-cloud-init.yaml
```
6. Make sure the file looks like the following by replacing `<SSID>` and `<PASSWORD>`
```bash
network:
  version: 2
  ethernets:
    eth0:
      dhcp4: true
      optional: true
  wifis:
    wlan0:
      dhcp4: true
      optional: true
      access-points:
        "<SSID>":
          password: "<PASSWORD>"
```
6. Save and Exit `nano` with `Ctrl+S` and `Ctrl+X`.
7. Apply the network settings with
```
sudo netplan apply
```
8. You may use `networkctl` to check if `wlan0` is connected to the wireless access point. `wlan0` should show green words on both statuses to be fully connected.
9. Download and run the `install_tbot_humble.sh` script
```bash
wget https://raw.githubusercontent.com/laiyankai/misc/main/install_tbot_humble.sh
chmod +x *.sh
./install_tbot_humble.sh
```
Take note of any errors, and any interactions.
10. The tb3 should automatically reboot.

# 2.3 Install script (Part 2)
1. Once the tb3 has booted, log in with the username and password.
2. Once logged in, run
```bash
./install_tbot_humble2.sh
```
Take note of any errors, and any interactions within the 2 to 3 hours it takes to update the robot.

# 2.4 Test robot
1. Once done, log out with `Ctrl+D`.
2. Log in again, and run
```bash
ros2 launch turtlebot3_bringup robot.launch.py
```
3. The print should state `Run!` if successful.
4. If successful, `Ctrl+C` to interrupt the program, and shutdown with:
```bash
sudo shutdown now
```
